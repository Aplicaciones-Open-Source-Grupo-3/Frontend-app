
<!-- Header -->
<section class="analytics" *ngIf="reports$ | async as reports">
  <header class="analytics__header">
    <h1>{{ 'ANALYTICS.OVERVIEW.TITLE' | translate }}</h1>
    <p>{{ 'ANALYTICS.OVERVIEW.DESCRIPTION' | translate }}</p>

  </header>
  <div class="analytics__widgets">
    <app-dashboard-widget *ngFor="let report of reports" [report]="report"></app-dashboard-widget>
  </div>
  <app-kpi-graph [title]="'ANALYTICS.GRAPH.TITLE' | translate"></app-kpi-graph>
</section>


<!-- Income Overview-->
<h3 class="section-title">{{ 'ANALYTICS.INCOME.TITLE' | translate }}</h3>
<div class="cards-grid">
  <article class="card">
    <h4>{{ 'ANALYTICS.INCOME.PERIOD' | translate }}</h4>
    <div class="chart-bars">
      <div class="bar" style="height:65%"></div>
      <div class="bar" style="height:55%"></div>
      <div class="bar" style="height:60%"></div>
      <div class="bar" style="height:70%"></div>
    </div>
    <small>{{ 'ANALYTICS.INCOME.LAST_MONTH' | translate }}</small>
    <div class="kpi">{{ (revenueKpi$ | async) | currency:'USD':'symbol':'1.0-0' }}</div>
  </article>

  <article class="card">
    <h4>{{ 'ANALYTICS.INCOME.BY_METHOD' | translate }}</h4>
    <div class="chart-bars">
      <div class="bar" style="height:60%"></div>
      <div class="bar" style="height:45%"></div>
      <div class="bar" style="height:75%"></div>
    </div>
    <small>{{ 'ANALYTICS.INCOME.LAST_MONTH' | translate }}</small>
    <ul class="legend">
      <li>{{ 'ANALYTICS.PAYMENT.CARD'   | translate }}</li>
      <li>{{ 'ANALYTICS.PAYMENT.CASH'   | translate }}</li>
      <li>{{ 'ANALYTICS.PAYMENT.MOBILE' | translate }}</li>
    </ul>
    <div class="kpi">{{ (revenueKpi$ | async) | currency:'USD':'symbol':'1.0-0' }}</div>
  </article>
</div>


<!-- Occupancy & Usage-->
<h3 class="section-title">{{ 'ANALYTICS.OCC.TITLE' | translate }}</h3>
<div class="cards-grid">
  <article class="card">
    <h4>{{ 'ANALYTICS.OCC.AVERAGE' | translate }}</h4>
    <div class="chart-line"></div>
    <small>{{ 'ANALYTICS.OCC.LAST_MONTH' | translate }}</small>
    <div class="kpi-sub">{{ (occupancyKpi$ | async) }}%</div>
  </article>

  <article class="card">
    <h4>{{ 'ANALYTICS.OCC.PEAK' | translate }}</h4>
    <div class="kpi">{{ 'ANALYTICS.OCC.PEAK_RANGE' | translate }}</div>
    <small>{{ 'ANALYTICS.OCC.LAST_MONTH' | translate }}</small>
    <div class="chart-bars slim">
      <div class="bar" style="height:50%"></div>
      <div class="bar" style="height:58%"></div>
      <div class="bar" style="height:60%"></div>
      <div class="bar" style="height:62%"></div>
      <div class="bar" style="height:60%"></div>
      <div class="bar" style="height:58%"></div>
      <div class="bar" style="height:55%"></div>
    </div>
  </article>

</div>



<!-- Customer & Subscription History -->
<h3 class="section-title">{{ 'ANALYTICS.HISTORY.TITLE' | translate }}</h3>
<div class="card no-pad">
  <div class="table-scroll">
    <table class="table">
      <thead>
      <tr>
        <th>{{ 'ANALYTICS.HISTORY.CUSTOMER' | translate }}</th>
        <th>{{ 'ANALYTICS.HISTORY.TYPE' | translate }}</th>
        <th>{{ 'ANALYTICS.HISTORY.START' | translate }}</th>
        <th>{{ 'ANALYTICS.HISTORY.END' | translate }}</th>
        <th>{{ 'ANALYTICS.HISTORY.STATUS' | translate }}</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let row of subHistory$ | async">
        <td>{{ row.customerName }}</td>
        <td>{{ row.subscriptionType }}</td>
        <td>{{ row.startDate | date:'yyyy-MM-dd' }}</td>
        <td>{{ row.endDate   | date:'yyyy-MM-dd' }}</td>
        <td>
            <span class="badge"
                  [class.badge--active]="row.status==='active'"
                  [class.badge--expired]="row.status==='expired'">
              {{ row.status | titlecase }}
            </span>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <div class="actions">
    <button type="button" class="btn" (click)="onExport()">
      {{ 'ANALYTICS.HISTORY.EXPORT' | translate }}
    </button>
    <button type="button" class="btn btn--primary" (click)="onGenerate()">
      {{ 'ANALYTICS.HISTORY.GENERATE' | translate }}
    </button>
  </div>
</div>

