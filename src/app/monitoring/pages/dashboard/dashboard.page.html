<section class="dashboard" *ngIf="vm$ | async as vm">
  <header class="dashboard__header">
    <div>
      <p class="dashboard__eyebrow">{{ 'MONITORING.DASHBOARD.TITLE' | translate }}</p>
      <h1>{{ 'MONITORING.DASHBOARD.HEADLINE' | translate }}</h1>
      <p class="dashboard__subtitle">{{ 'MONITORING.DASHBOARD.DESCRIPTION' | translate }}</p>
    </div>
  </header>

  <div class="dashboard__map">
    <ng-container *ngIf="mapUrl(); else loadingMap">
      <iframe
        class="dashboard__map-iframe"
        [src]="mapUrl()"
        frameborder="0"
        scrolling="no"
        marginheight="0"
        marginwidth="0"
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        allowfullscreen>
      </iframe>
    </ng-container>
    <ng-template #loadingMap>
      <div class="dashboard__map-placeholder">
        <p>Cargando mapa...</p>
      </div>
    </ng-template>
    <ng-container *ngIf="locationError() as error">
      <div class="dashboard__map-error">
        <small>{{ error }}</small>
      </div>
    </ng-container>
  </div>

  <app-parking-lot-status [overview]="vm.overview"></app-parking-lot-status>

  <div class="dashboard__grid">
    <app-incident-list [incidents]="vm.incidents"></app-incident-list>
    <app-vehicle-entry-exit [movements]="vm.movements"></app-vehicle-entry-exit>
  </div>
</section>
